<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Deconstructing Unity Android Apps | Heath Farrow .dev</title><meta name=keywords content><meta name=description content="Analyzing a deconstructed Unity Android application."><meta name=author content="Heath Farrow"><link rel=canonical href=https://heathfarrow.dev/posts/deconstructing-unity-android-apps/><link crossorigin=anonymous href=/assets/css/stylesheet.9c4f5aa85dab72ee82fc33b8dfb12a3f7459e6c1b389f9fae73095efa3ecb4d6.css integrity="sha256-nE9aqF2rcu6C/DO437EqP3RZ5sGzifn65zCV76PstNY=" rel="preload stylesheet" as=style><link rel=icon href=https://heathfarrow.dev/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://heathfarrow.dev/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://heathfarrow.dev/favicon-32x32.png><link rel=apple-touch-icon href=https://heathfarrow.dev/apple-touch-icon.png><link rel=mask-icon href=https://heathfarrow.dev/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Deconstructing Unity Android Apps"><meta property="og:description" content="Analyzing a deconstructed Unity Android application."><meta property="og:type" content="article"><meta property="og:url" content="https://heathfarrow.dev/posts/deconstructing-unity-android-apps/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-02-09T00:00:00+00:00"><meta property="article:modified_time" content="2023-02-09T00:00:00+00:00"><meta property="og:site_name" content="Heath Farrow .dev"><meta name=twitter:card content="summary"><meta name=twitter:title content="Deconstructing Unity Android Apps"><meta name=twitter:description content="Analyzing a deconstructed Unity Android application."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://heathfarrow.dev/posts/"},{"@type":"ListItem","position":3,"name":"Deconstructing Unity Android Apps","item":"https://heathfarrow.dev/posts/deconstructing-unity-android-apps/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Deconstructing Unity Android Apps","name":"Deconstructing Unity Android Apps","description":"Analyzing a deconstructed Unity Android application.","keywords":[],"articleBody":"Recently, I was interested in comparing two Android games built with Unity. I was particularly interested in analyzing how much font data each game included in the package submitted to the Google Play Store. A basic analysis of included files and their sizes can be accomplished with the following tools.\nadb adb shell pm list - Find the app ID of the target by listing all installed apps adb shell pm path - Find the unique install path of the provided app ID adb pull - Transfer the app files to your computer for further analysis zipinfo - Inspect the content and compressed file sizes of a .zip archive apktool - Unpack an Android application package (.akp) for further analysis AssetRipper - A tool for extracting assets from serialized files (CAB-*, *.assets, *.sharedAssets, etc.) and assets bundles (*.unity3d, *.bundle, etc.) and converting them into the native Unity engine format. For this post, we are going to take a look at Marvel Snap. The Snap download from the Play Store is under 150mb; however, it does appear to download a small amount of data when launched and more data as you progress. Developers may desire their submitted app package to be under 150mb because it can be downloaded on a mobile data plan without prompting the user about the download size. The Apple App Store has a similar limit of 200mb.\nThe analysis conducted for this post was performed on Windows with WSL2, Ubuntu, and ZSH. You may already have an Android development environment setup with adb available in your PATH variable. If not, here are some general instructions for installing adb on Ubuntu. The following sections go into more detail about setting up adb for use with WSL2 and connecting an Android device.\nEnable USB Debugging on Android device First, we enable developer mode on our Android device. The steps for doing this can vary by version of Android or by the manufacturer. Check out the Android developer docs for instructions on enabling developer mode and USB debugging.\nSetting Up ADB on WSL2 To perform any analysis, it is helpful to copy the app files to your computer. This is done with the Android Debug Bridge (adb). Getting adb to connect to an Android device on WSL2 requires some extra steps. If we were to run adb devices without additional WSL2 setup, we should see the following output and notice that no devices are listed.\n❯ adb devices * daemon not running; starting now at tcp:5037 * daemon started successfully List of devices attached We need to install ADB on both Windows and WSL2. Here is how we install ADB on Windows:\nDownload the Android SDK Platform Tools ZIP for Windows\nExtract this to a location such as %USERPROFILE%\\AppData\\Local\\Android\\platform-tools\nAdd the above path to the Path environment variable\nWith our Android device connected and USB debugging enabled, ADB may not yet recognize your device. If we run adb devices in Powershell and it does not list any devices, try running the following before checking for the device again:\nadb kill-server adb start-server adb devices If we disconnect the Android device from USB and reconnect it we should be prompted on the device to allow the Windows machine to connect. Further troubleshooting will be required if adb devices does not list the device as seen below.\nPS C:\\Users\\heath\u003e adb devices List of devices attached 1A021FDEE0088H device In Powershell run adb tcpip 5555\nIn WSL2 run adb connect :5555 where is the local network IP address of your Android device\nThe output might contain something like “failed to authenticate to :5555” but there may have another prompt to accept on the Android device. Run the adb connect command again and it should output something like “already connected to :5555”\nIn WSL2 confirm that adb devices now lists the Android device.\n❯ adb devices List of devices attached :5555 device Transfer the App files First, we need to know the app identifier for the target app. In my case, the target app is Marvel Snap. We use adb shell pm list packages to list the app identifiers of all installed apps on the device. Hopefully, your target app has an identifier you can recognize. The output of the command will look like this:\n❯ adb shell pm list packages package:com.google.audio.hearing.visualization.accessibility.scribe package:com.android.systemui.auto_generated_rro_vendor__ package:com.google.android.providers.media.module package:com.google.android.overlay.permissioncontroller package:com.google.android.overlay.googlewebview package:com.android.calllogbackup Marvel Snap will appear in the list as package:com.nvsgames.snap. Next, we need to discover the path on the device to the installed app. The path is lightly obfuscated and will change each time you install the app. Now we use adb shell pm path com.nvsgames.snap to discover the path we need.\n❯ adb shell pm path com.nvsgames.snap package:/data/app/~~3ptHVzClzNmwSowM3hAu0A==/com.nvsgames.snap-kVFALO2K7yXXBtqhMI35dw==/base.apk package:/data/app/~~3ptHVzClzNmwSowM3hAu0A==/com.nvsgames.snap-kVFALO2K7yXXBtqhMI35dw==/split_config.arm64_v8a.apk We can see above that the path we need for the next step is /data/app/~~3ptHVzClzNmwSowM3hAu0A==/com.nvsgames.snap-kVFALO2K7yXXBtqhMI35dw==/. Finally, we can copy the files to the computer where the device is connected. Change to the directory where we want to copy files to and run adb pull where is the app path we found above. The command output will update as it copies files but after it has completed it will look similar to below:\n❯ adb pull /data/app/~~3ptHVzClzNmwSowM3hAu0A==/com.nvsgames.snap-kVFALO2K7yXXBtqhMI35dw==/ adb: warning: skipping special file '/data/app/~~3ptHVzClzNmwSowM3hAu0A==/com.nvsgames.snap-kVFALO2K7yXXBtqhMI35dw==/oat' (mode = 0o0) /data/app/~~3ptHVzClzNmwSowM3hAu0A==/com.nvsgames.snap-kVFALO2K7yXXBtqhMI35dw==/: 35 files pulled, 1 skipped. 18.8 MB/s (256557359 bytes in 13.032s) Analyzing the App files Great! The files are on our computer and ready for further analysis. This post is by no means an extensive analysis guide but next, I’ll point out a few things related to the sizes of different sections of the app. We will also take a look at deconstructing parts of the Unity app to see its contents.\nBefore we get too far, let’s take a quick look at the contents of the files we transferred. For Snap, it should look like the following:\n❯ tree . ├── base.apk ├── base.dm ├── lib │ └── arm64 │ ├── libalog.so │ ├── libbacktrace-native.so │ ├── libbreakpad_client.so │ ├── lib_burst_generated.so │ ├── libbytehook.so │ ├── libcpuinfo.so │ ├── libcrashpad_handler.so │ ├── libc++_shared.so │ ├── libEncryptor.so │ ├── libgp_base.so │ ├── libgpm.so │ ├── libgp.so │ ├── libgsdk_base.so │ ├── libil2cpp.so │ ├── libkeva.so │ ├── libmain.so │ ├── libmonitorcollector-lib.so │ ├── libnative-lib.so │ ├── libnpth_dl.so │ ├── libnpth_dumper.so │ ├── libnpth_heap_tracker.so │ ├── libnpth_logcat.so │ ├── libnpth.so │ ├── libnpth_tools.so │ ├── libnpth_wrapper.so │ ├── libnpth_xasan.so │ ├── libping.so │ ├── libsscronet.so │ ├── libttboringssl.so │ ├── libttcrypto.so │ ├── libttgame_tps_client.so │ └── libunity.so └── split_config.arm64_v8a.apk Snap is a relatively simple package. Everything fits in the base APK and no Android Asset Packs are used to provide additional data. There is a limit to how large the base APK can be before asset packs must be introduced. Asset packs themselves have size and quantity limits. To learn more about asset packs, check out the Play Asset Delivery documentation. An additional point of interest is that if an App Store download is under 150mb, it can be downloaded on a mobile data plan without prompting the user. It’s assumed that more users will download your app if they are not concerned about it using a significant portion of a user’s monthly data cap.\nWhen an app is submitted to the Play Store, it will be processed by Google. The base APK will have binaries split into additional APKs for each supported target architecture. We can see in the output above that the binary APK is called split_config.arm64_v8a.apk.\nAdditionally, the binary APK contains compressed binaries that need to be extracted before the app can run. During app installation, the binaries are extracted to the lib/ directory as seen in the output above.\nAnalyzing the binaries may give insight into how the app is structured or what third-party libraries the app is using. Snap is a Unity app so it’s no surprise that we see libunity.so and libil2cpp.so. As an arbitrary example, we can see that Snap is using Backtrace for crash and error reporting based on the presence of libbacktrace-native.so and libcrashpad_handler.so.\nAnalyzing Binary Sizes We can easily look at the binaries in lib/ to understand the extracted size of the files; however, I am more interested in the compressed size of binaries as it relates to App Store size limits and the 150mb threshold. We need to have a look inside the binary APK and to do this we will use the zipinfo command. If you don’t have zipinfo installed, you can install it on WSL2 with sudo adb install zip unzip. We could simply look at the size of the binary APK to understand the size of all binaries but I’m interested in looking at the size of individual binaries.\nLet’s take a look by running zipinfo -lt split_config.arm64_v8a.apk\n❯ zipinfo -lt split_config.arm64_v8a.apk Archive: split_config.arm64_v8a.apk Zip file size: 40147658 bytes, number of entries: 37 -rw-r--r-- 0.0 unx 952 b- 419 defN 81-Jan-01 01:01 AndroidManifest.xml -rw-r--r-- 0.0 unx 75744 b- 25809 defN 81-Jan-01 01:01 lib/arm64-v8a/libEncryptor.so -rw-r--r-- 0.0 unx 361000 b- 158184 defN 81-Jan-01 01:01 lib/arm64-v8a/lib_burst_generated.so -rw-r--r-- 0.0 unx 121208 b- 66067 defN 81-Jan-01 01:01 lib/arm64-v8a/libalog.so -rw-r--r-- 0.0 unx 1485240 b- 464514 defN 81-Jan-01 01:01 lib/arm64-v8a/libbacktrace-native.so -rw-r--r-- 0.0 unx 182328 b- 69734 defN 81-Jan-01 01:01 lib/arm64-v8a/libbreakpad_client.so -rw-r--r-- 0.0 unx 43536 b- 20925 defN 81-Jan-01 01:01 lib/arm64-v8a/libbytehook.so -rw-r--r-- 0.0 unx 911696 b- 272821 defN 81-Jan-01 01:01 lib/arm64-v8a/libc++_shared.so -rw-r--r-- 0.0 unx 27456 b- 10914 defN 81-Jan-01 01:01 lib/arm64-v8a/libcpuinfo.so -rw-r--r-- 0.0 unx 2917440 b- 1344878 defN 81-Jan-01 01:01 lib/arm64-v8a/libcrashpad_handler.so -rw-r--r-- 0.0 unx 3395632 b- 1241680 defN 81-Jan-01 01:01 lib/arm64-v8a/libgp.so -rw-r--r-- 0.0 unx 519264 b- 207392 defN 81-Jan-01 01:01 lib/arm64-v8a/libgp_base.so -rw-r--r-- 0.0 unx 977104 b- 310883 defN 81-Jan-01 01:01 lib/arm64-v8a/libgpm.so -rw-r--r-- 0.0 unx 10312 b- 3595 defN 81-Jan-01 01:01 lib/arm64-v8a/libgsdk_base.so -rw-r--r-- 0.0 unx 85567976 b- 24113775 defN 81-Jan-01 01:01 lib/arm64-v8a/libil2cpp.so -rw-r--r-- 0.0 unx 203368 b- 67908 defN 81-Jan-01 01:01 lib/arm64-v8a/libkeva.so -rw-r--r-- 0.0 unx 10416 b- 2629 defN 81-Jan-01 01:01 lib/arm64-v8a/libmain.so -rw-r--r-- 0.0 unx 243992 b- 87711 defN 81-Jan-01 01:01 lib/arm64-v8a/libmonitorcollector-lib.so -rw-r--r-- 0.0 unx 223288 b- 76642 defN 81-Jan-01 01:01 lib/arm64-v8a/libnative-lib.so -rw-r--r-- 0.0 unx 76616 b- 37492 defN 81-Jan-01 01:01 lib/arm64-v8a/libnpth.so -rw-r--r-- 0.0 unx 26560 b- 11422 defN 81-Jan-01 01:01 lib/arm64-v8a/libnpth_dl.so -rw-r--r-- 0.0 unx 121704 b- 63883 defN 81-Jan-01 01:01 lib/arm64-v8a/libnpth_dumper.so -rw-r--r-- 0.0 unx 59344 b- 27079 defN 81-Jan-01 01:01 lib/arm64-v8a/libnpth_heap_tracker.so -rw-r--r-- 0.0 unx 27000 b- 11889 defN 81-Jan-01 01:01 lib/arm64-v8a/libnpth_logcat.so -rw-r--r-- 0.0 unx 83896 b- 35318 defN 81-Jan-01 01:01 lib/arm64-v8a/libnpth_tools.so -rw-r--r-- 0.0 unx 6048 b- 1425 defN 81-Jan-01 01:01 lib/arm64-v8a/libnpth_wrapper.so -rw-r--r-- 0.0 unx 42920 b- 17910 defN 81-Jan-01 01:01 lib/arm64-v8a/libnpth_xasan.so -rw-r--r-- 0.0 unx 14144 b- 4765 defN 81-Jan-01 01:01 lib/arm64-v8a/libping.so -rw-r--r-- 0.0 unx 4428584 b- 2029259 defN 81-Jan-01 01:01 lib/arm64-v8a/libsscronet.so -rw-r--r-- 0.0 unx 341976 b- 142671 defN 81-Jan-01 01:01 lib/arm64-v8a/libttboringssl.so -rw-r--r-- 0.0 unx 1170688 b- 466898 defN 81-Jan-01 01:01 lib/arm64-v8a/libttcrypto.so -rw-r--r-- 0.0 unx 530640 b- 248325 defN 81-Jan-01 01:01 lib/arm64-v8a/libttgame_tps_client.so -rw-r--r-- 0.0 unx 20348216 b- 8486117 defN 81-Jan-01 01:01 lib/arm64-v8a/libunity.so -rw---- 2.0 fat 32 b- 35 defN 81-Jan-01 01:01 stamp-cert-sha256 -rw---- 2.0 fat 2912 b- 1200 defN 81-Jan-01 01:01 META-INF/BNDLTOOL.SF -rw---- 2.0 fat 1405 b- 1067 defN 81-Jan-01 01:01 META-INF/BNDLTOOL.RSA -rw---- 2.0 fat 2804 b- 1125 defN 81-Jan-01 01:01 META-INF/MANIFEST.MF 37 files, 124563441 bytes uncompressed, 40134360 bytes compressed: 67.8% We can see in the last line the total uncompressed and compressed size of all the files. We also see a compression ratio of 67.8%. For each file, we can see the compressed and uncompressed size in bytes of each file. If you would rather see the compression ratio as a percent instead of size in bytes, you can change the arguments we used and run zipinfo -mt split_config.arm64_v8a.apk\n❯ zipinfo -mt split_config.arm64_v8a.apk Archive: split_config.arm64_v8a.apk Zip file size: 40147658 bytes, number of entries: 37 -rw-r--r-- 0.0 unx 952 b- 56% defN 81-Jan-01 01:01 AndroidManifest.xml -rw-r--r-- 0.0 unx 75744 b- 66% defN 81-Jan-01 01:01 lib/arm64-v8a/libEncryptor.so -rw-r--r-- 0.0 unx 361000 b- 56% defN 81-Jan-01 01:01 lib/arm64-v8a/lib_burst_generated.so -rw-r--r-- 0.0 unx 121208 b- 46% defN 81-Jan-01 01:01 lib/arm64-v8a/libalog.so -rw-r--r-- 0.0 unx 1485240 b- 69% defN 81-Jan-01 01:01 lib/arm64-v8a/libbacktrace-native.so -rw-r--r-- 0.0 unx 182328 b- 62% defN 81-Jan-01 01:01 lib/arm64-v8a/libbreakpad_client.so -rw-r--r-- 0.0 unx 43536 b- 52% defN 81-Jan-01 01:01 lib/arm64-v8a/libbytehook.so -rw-r--r-- 0.0 unx 911696 b- 70% defN 81-Jan-01 01:01 lib/arm64-v8a/libc++_shared.so -rw-r--r-- 0.0 unx 27456 b- 60% defN 81-Jan-01 01:01 lib/arm64-v8a/libcpuinfo.so -rw-r--r-- 0.0 unx 2917440 b- 54% defN 81-Jan-01 01:01 lib/arm64-v8a/libcrashpad_handler.so -rw-r--r-- 0.0 unx 3395632 b- 63% defN 81-Jan-01 01:01 lib/arm64-v8a/libgp.so -rw-r--r-- 0.0 unx 519264 b- 60% defN 81-Jan-01 01:01 lib/arm64-v8a/libgp_base.so -rw-r--r-- 0.0 unx 977104 b- 68% defN 81-Jan-01 01:01 lib/arm64-v8a/libgpm.so -rw-r--r-- 0.0 unx 10312 b- 65% defN 81-Jan-01 01:01 lib/arm64-v8a/libgsdk_base.so -rw-r--r-- 0.0 unx 85567976 b- 72% defN 81-Jan-01 01:01 lib/arm64-v8a/libil2cpp.so -rw-r--r-- 0.0 unx 203368 b- 67% defN 81-Jan-01 01:01 lib/arm64-v8a/libkeva.so -rw-r--r-- 0.0 unx 10416 b- 75% defN 81-Jan-01 01:01 lib/arm64-v8a/libmain.so -rw-r--r-- 0.0 unx 243992 b- 64% defN 81-Jan-01 01:01 lib/arm64-v8a/libmonitorcollector-lib.so -rw-r--r-- 0.0 unx 223288 b- 66% defN 81-Jan-01 01:01 lib/arm64-v8a/libnative-lib.so -rw-r--r-- 0.0 unx 76616 b- 51% defN 81-Jan-01 01:01 lib/arm64-v8a/libnpth.so -rw-r--r-- 0.0 unx 26560 b- 57% defN 81-Jan-01 01:01 lib/arm64-v8a/libnpth_dl.so -rw-r--r-- 0.0 unx 121704 b- 48% defN 81-Jan-01 01:01 lib/arm64-v8a/libnpth_dumper.so -rw-r--r-- 0.0 unx 59344 b- 54% defN 81-Jan-01 01:01 lib/arm64-v8a/libnpth_heap_tracker.so -rw-r--r-- 0.0 unx 27000 b- 56% defN 81-Jan-01 01:01 lib/arm64-v8a/libnpth_logcat.so -rw-r--r-- 0.0 unx 83896 b- 58% defN 81-Jan-01 01:01 lib/arm64-v8a/libnpth_tools.so -rw-r--r-- 0.0 unx 6048 b- 76% defN 81-Jan-01 01:01 lib/arm64-v8a/libnpth_wrapper.so -rw-r--r-- 0.0 unx 42920 b- 58% defN 81-Jan-01 01:01 lib/arm64-v8a/libnpth_xasan.so -rw-r--r-- 0.0 unx 14144 b- 66% defN 81-Jan-01 01:01 lib/arm64-v8a/libping.so -rw-r--r-- 0.0 unx 4428584 b- 54% defN 81-Jan-01 01:01 lib/arm64-v8a/libsscronet.so -rw-r--r-- 0.0 unx 341976 b- 58% defN 81-Jan-01 01:01 lib/arm64-v8a/libttboringssl.so -rw-r--r-- 0.0 unx 1170688 b- 60% defN 81-Jan-01 01:01 lib/arm64-v8a/libttcrypto.so -rw-r--r-- 0.0 unx 530640 b- 53% defN 81-Jan-01 01:01 lib/arm64-v8a/libttgame_tps_client.so -rw-r--r-- 0.0 unx 20348216 b- 58% defN 81-Jan-01 01:01 lib/arm64-v8a/libunity.so -rw---- 2.0 fat 32 b- -8% defN 81-Jan-01 01:01 stamp-cert-sha256 -rw---- 2.0 fat 2912 b- 59% defN 81-Jan-01 01:01 META-INF/BNDLTOOL.SF -rw---- 2.0 fat 1405 b- 24% defN 81-Jan-01 01:01 META-INF/BNDLTOOL.RSA -rw---- 2.0 fat 2804 b- 60% defN 81-Jan-01 01:01 META-INF/MANIFEST.MF 37 files, 124563441 bytes uncompressed, 40134360 bytes compressed: 67.8% A quick observation is that the Unity app binaries are large. I also checked apps like Clash Royale and Brawl Stars. Their binary sizes were significantly smaller. The Unity engine alone can be as large as the code base for entire games.\nAnalyzing Embedded Asset Bundles Using apktool we can unpack base.apk. apktool can be installed with sudo apt install apktool. It’s worth noting that an APK is essentially a zip archive. You can extract it like a regular zip archive. Hopefully, this was apparent when we used zipinfo to look inside the binary APK. However, simply unzipping the APK will leave parts like the AndroidManifest.xml unreadable.\nUnpack the base APK with apktool d base.apk.\n❯ apktool d base.apk I: Using Apktool 2.5.0-dirty on base.apk I: Loading resource table... I: Decoding AndroidManifest.xml with resources... I: Loading resource table from file: /home/hfarrow/.local/share/apktool/framework/1.apk I: Regular manifest package... I: Decoding file-resources... I: Decoding values */* XMLs... I: Baksmaling classes.dex... I: Baksmaling classes2.dex... I: Baksmaling classes3.dex... I: Baksmaling classes4.dex... I: Baksmaling classes5.dex... I: Baksmaling classes6.dex... I: Copying assets and libs... I: Copying unknown files... I: Copying original files... I: Copying META-INF/services directory We should now see a directory named base. Here is a look at the top-level directory listing:\n❯ tree -L 1 . ├── AndroidManifest.xml ├── apktool.yml ├── assets ├── kotlin ├── META-INF ├── original ├── res ├── smali ├── smali_classes2 ├── smali_classes3 ├── smali_classes4 ├── smali_classes5 ├── smali_classes6 └── unknown Notice that if you open AndroidManifest.xml it will be readable. We aren’t interested in the manifest for the purpose of this post but it’s useful to know about. Even when troubleshooting your own Unity app, it can be useful to view the manifest in your built APK to verify the final manifest is what you expected.\nWe are interested in app size so let’s take a high-level look at the distribution of large files in the APK. Another handy tool I used in my terminal is broot. It has “whale” mode that will sort and display files by size. Install broot with sudo apt install broot and then run broot -m in the unpacked APK directory.\nFor our purposes, we are interested in the assets directory where we will find the contents of the Unity project’s Assets/StreamingAssets/, and all the assets that were embedded as part of scenes and Resources/ directories. Let’s move broot into the assets directory and take another look.\nFrom inspecting the contents of aa we can determine that Snap uses the Addressable system and that the Android directory contains asset bundles embedded into the app.\nWhen you embed asset bundles into a Unity APK, you have the decision to make. Do you compress the asset bundle in the APK archive or do you leave them uncompressed? Compressing the bundles is in addition to the compression setting used to build the individual bundles. That is to say, you can double-compress asset bundles. The contents of a bundle itself can be compressed and the section of the APK archive containing the bundle can also be compressed.\nCompressing bundles in the APK will help reduce the size of your APK but it comes with a significant trade-off. At runtime, loading an asset bundle out of the APK will be significantly slower because Unity will have to extract the file out of the APK to read it into memory. As an example, in a game I worked on where we pre-loaded many bundles, compressing the bundles increased app startup time by at least a multiple of 4 on decent hardware. You can improve this experience by extracting the asset bundles and caching them outside of the APK. Unity has a built-in asset bundle cache and if you load bundles through a UnityWebRequest, I believe it will automatically perform this step for you. There is still a trade-off that the first time you load a bundle, you need to extract it. The app should be tested to determine how this affects the user experience and if the trade-off is acceptable. Having longer load times on a player’s first session might impact their impression negatively. No one likes long loading phases.\nSo, are Snap bundles compressed in the APK or not? We can go back to zipinfo to analyze the base.apk. zipinfo can take a trailing argument that is a file filter for the output. Try running zipinfo -m base.apk assets/aa/Android/\\* to only output info about the asset bundles. Below we can see the first few lines of output but all the bundles are using the same compression strategy.\n❯ zipinfo -m base.apk assets/aa/Android/\\* -rw-r--r-- 0.0 unx 3566 b- 19% defN 81-Jan-01 01:01 assets/aa/Android/0ea51b79af36d03ba15ac4b5ea3be170.bundle -rw-r--r-- 0.0 unx 3547 b- 19% defN 81-Jan-01 01:01 assets/aa/Android/4ed2cdfb0e9393601d4ffe68e478f867.bundle -rw-r--r-- 0.0 unx 4850 b- 23% defN 81-Jan-01 01:01 assets/aa/Android/515070c0151e19d075d62b181d0d1c29.bundle -rw-r--r-- 0.0 unx 9698 b- 20% defN 81-Jan-01 01:01 assets/aa/Android/5e4bad4874a8ef52921df1b8d1188b7c.bundle -rw-r--r-- 0.0 unx 20358 b- 18% defN 81-Jan-01 01:01 assets/aa/Android/6c14c35b58746c8605fc410e435b38b5.bundle -rw-r--r-- 0.0 unx 70554 b- 40% defN 81-Jan-01 01:01 assets/aa/Android/6e507c8d892466c20bdc6e65eeff6f19.bundle -rw-r--r-- 0.0 unx 4716 b- 20% defN 81-Jan-01 01:01 assets/aa/Android/87b3b19c363616f26590d1191c153135.bundle -rw-r--r-- 0.0 unx 8920 b- 18% defN 81-Jan-01 01:01 assets/aa/Android/8965793a594f49ff7b8283b12bdab12b.bundle -rw-r--r-- 0.0 unx 14902 b- 18% defN 81-Jan-01 01:01 assets/aa/Android/93d9c5e9586500293f5fe79095052b54.bundle -rw-r--r-- 0.0 unx 110994 b- 17% defN 81-Jan-01 01:01 assets/aa/Android/b0d5d1c80db4e7ada5b102f136b05c06.bundle -rw-r--r-- 0.0 unx 1844795 b- 0% defN 81-Jan-01 01:01 assets/aa/Android/baked-smalllogos_assets_all_a01de1e78f3277d29d3895934ef45348.bundle -rw-r--r-- 0.0 unx 2239676 b- 15% defN 81-Jan-01 01:01 assets/aa/Android/bundledinapp-card_assets_all_72d770ac4c8ab54515d4be59bf32c3eb.bundle -rw-r--r-- 0.0 unx 8582 b- 22% defN 81-Jan-01 01:01 assets/aa/Android/bundledinapp-font_assets_applesdf_3f50ebe88e074a9767830cc1fb5c5f24.bundle -rw-r--r-- 0.0 unx 8103 b- 21% defN 81-Jan-01 01:01 assets/aa/Android/bundledinapp-font_assets_contentsdf_0e9b61d8eb8d950cf81900554acab2a1.bundle -rw-r--r-- 0.0 unx 8596 b- 22% defN 81-Jan-01 01:01 assets/aa/Android/bundledinapp-font_assets_googlesdf_2263bf4501d15f601a859e5d86fafa67.bundle -rw-r--r-- 0.0 unx 22919 b- 21% defN 81-Jan-01 01:01 assets/aa/Android/bundledinapp-font_assets_header_891ee8005509ee8884e463deb3b810f2.bundle -rw-r--r-- 0.0 unx 8158 b- 21% defN 81-Jan-01 01:01 assets/aa/Android/bundledinapp-font_assets_headersdf_cc807b1a807e72e2f7bb8d9ef97eb82a.bundle -rw-r--r-- 0.0 unx 353188 b- 11% defN 81-Jan-01 01:01 assets/aa/Android/bundledinapp-font_assets_helveticaneueltstd-mdcnsdf_a49787f3b1b5550c636345c5aaa010e9.bundle -rw-r--r-- 0.0 unx 29498 b- 29% defN 81-Jan-01 01:01 assets/aa/Android/bundledinapp-font_assets_tmp_sdf-mobile_590e52215c1985ca7d514bcd1eee9c5b.bundle -rw-r--r-- 0.0 unx 31015 b- 29% defN 81-Jan-01 01:01 assets/aa/Android/bundledinapp-font_assets_tmp_sdf-mobilemasking_f14fca07d81ca13d20379d31d61ecd97.bundle At a glance, we can confirm the asset bundles are compressed. The defN value in the 7th column confirms this but so does the fact that we see compression ratios in the 6th column. Interestingly and assuming this was a deliberate choice, this may have helped the developers keep their APK under the Play Store 150mb limit I mentioned previously. I won’t go so far for this post but one could play the app and inspect the app data to see if the embedded bundles are being cached outside of the APK.\nThe compression ratio varies widely among the bundles. We can see values ranging from single digits up to 59%. If you run zipinfo again with the -t flag added, the final line of output will include the total compression ratio of all files. We see that the overall compression ratio is 10.5%.\n❯ zipinfo -mt base.apk assets/aa/Android/\\* 235 files, 65842186 bytes uncompressed, 58926405 bytes compressed: 10.5% Analyzing Asset Bundles Contents In the previous steps, we already extracted all asset bundles when we unpacked the base.apk and they can be found in ./base/assets/aa/Android/. We can create an empty Unity project and install the Asset Bundle Browser tool package. The link contains installation instructions and a link to the tool’s documentation. With this tool, we can add the assets/aa/Android/ directory and inspect all the bundles together. We can collect a lot of information about the bundles doing this but I’ve chosen to skip doing so for this post.\nAnalyzing Embedded Scenes and Resources We already looked at asset bundles but what about all the assets referenced by embedded scenes and assets found inside Resources/ directories in the project’s Assets/ directory? All of that data can be found in base/assets/bin/Data/data.unity3d.\nI may come back in the future and expand this section further but for now, I’ll just point out that a tool called Asset Ripper that can both inspect the contents of this file and export a Unity project containing much of the contents. For a Standalone player using the mono backend you can decompile scripts but for an Android or iOS game using the IL2CPP backend that will not be possible. Asset Ripper is an insightful tool for looking at the contents and structure of the project. For my purposes, I was interested in looking at how much font data was embedded in the APK and I accomplished that goal with this tool.\nAsset Ripper can also be used to inspect and unpack individual assets bundles; although, I didn’t go that far for my purposes as the Asset Bundle Browser was sufficient and more convenient to use.\nThere is a lot more to be said about deconstructing, reverse engineering, and analyzing an Android app but I think this serves as a good introduction to the topic.\n","wordCount":"3737","inLanguage":"en","datePublished":"2023-02-09T00:00:00Z","dateModified":"2023-02-09T00:00:00Z","author":{"@type":"Person","name":"Heath Farrow"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://heathfarrow.dev/posts/deconstructing-unity-android-apps/"},"publisher":{"@type":"Organization","name":"Heath Farrow .dev","logo":{"@type":"ImageObject","url":"https://heathfarrow.dev/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://heathfarrow.dev accesskey=h title="Heath Farrow .dev (Alt + H)">Heath Farrow .dev</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://heathfarrow.dev/posts/ title=Posts><span>Posts</span></a></li><li><a href=https://heathfarrow.dev/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://www.linkedin.com/in/heathfarrow/ title=LinkedIn><span>LinkedIn</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li><li><a href=https://github.com/hfarrow title=GitHub><span>GitHub</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://heathfarrow.dev>Home</a>&nbsp;»&nbsp;<a href=https://heathfarrow.dev/posts/>Posts</a></div><h1 class=post-title>Deconstructing Unity Android Apps</h1><div class=post-description>Analyzing a deconstructed Unity Android application.</div><div class=post-meta><span title='2023-02-09 00:00:00 +0000 UTC'>February 9, 2023</span>&nbsp;·&nbsp;18 min&nbsp;·&nbsp;3737 words&nbsp;·&nbsp;Heath Farrow</div></header><div class=post-content><p>Recently, I was interested in comparing two Android games built with Unity. I was particularly interested in analyzing
how much font data each game included in the package submitted to the Google Play Store. A basic analysis of included
files and their sizes can be accomplished with the following tools.</p><ul><li>adb<ul><li><code>adb shell pm list</code> - Find the app ID of the target by listing all installed apps</li><li><code>adb shell pm path</code> - Find the unique install path of the provided app ID</li><li><code>adb pull</code> - Transfer the app files to your computer for further analysis</li></ul></li><li>zipinfo - Inspect the content and compressed file sizes of a <code>.zip</code> archive</li><li>apktool - Unpack an Android application package (<code>.akp</code>) for further analysis</li><li>AssetRipper - A tool for extracting assets from serialized files (<code>CAB-*</code>, <code>*.assets</code>, <code>*.sharedAssets</code>, etc.) and
assets bundles (*.unity3d, *.bundle, etc.) and converting them into the native Unity engine format.</li></ul><p>For this post, we are going to take a look at Marvel Snap. The Snap download from the Play Store is under 150mb;
however, it does appear to download a small amount of data when launched and more data as you progress. Developers may
desire their submitted app package to be under 150mb because it can be downloaded on a mobile data plan without
prompting the user about the download size. The Apple App Store has a similar limit of 200mb.</p><p>The analysis conducted for this post was performed on Windows with WSL2, Ubuntu, and ZSH. You may already have an
Android development environment setup with <code>adb</code> available in your PATH variable. If not, here are some <a href=https://www.xda-developers.com/install-adb-windows-macos-linux/>general
instructions</a> for installing <code>adb</code> on Ubuntu. The
following sections go into more detail about setting up <code>adb</code> for use with WSL2 and connecting an Android device.</p><h2 id=enable-usb-debugging-on-android-device>Enable USB Debugging on Android device<a hidden class=anchor aria-hidden=true href=#enable-usb-debugging-on-android-device>#</a></h2><p>First, we enable developer mode on our Android device. The steps for doing this can vary by version of Android or by the
manufacturer. Check out the <a href=https://developer.android.com/studio/debug/dev-options>Android developer docs</a> for
instructions on enabling developer mode and USB debugging.</p><h2 id=setting-up-adb-on-wsl2>Setting Up ADB on WSL2<a hidden class=anchor aria-hidden=true href=#setting-up-adb-on-wsl2>#</a></h2><p>To perform any analysis, it is helpful to copy the app files to your computer. This is done with the Android Debug
Bridge (<code>adb</code>). Getting <code>adb</code> to connect to an Android device on WSL2 requires some extra steps. If we were to run <code>adb devices</code> without additional WSL2 setup, we should see the following output and notice that no devices are listed.</p><pre tabindex=0><code>❯ adb devices
* daemon not running; starting now at tcp:5037
* daemon started successfully
List of devices attached
</code></pre><p>We need to install ADB on both Windows and WSL2. Here is how we install ADB on Windows:</p><ol><li><p>Download the <a href=https://dl.google.com/android/repository/platform-tools-latest-windows.zip>Android SDK Platform Tools ZIP for
Windows</a></p></li><li><p>Extract this to a location such as <code>%USERPROFILE%\AppData\Local\Android\platform-tools</code></p></li><li><p>Add the above path to the <code>Path</code> environment variable</p></li><li><p>With our Android device connected and USB debugging enabled, ADB may not yet recognize your device. If we run <code>adb devices</code> in Powershell and it does not list any devices, try running the following before checking for the device
again:</p><pre tabindex=0><code>adb kill-server
adb start-server
adb devices
</code></pre><p>If we disconnect the Android device from USB and reconnect it we should be prompted on the device to allow the
Windows machine to connect. Further troubleshooting will be required if <code>adb devices</code> does not list the device as
seen below.</p><pre tabindex=0><code>PS C:\Users\heath&gt; adb devices
List of devices attached
1A021FDEE0088H  device
</code></pre></li><li><p>In Powershell run <code>adb tcpip 5555</code></p></li><li><p>In WSL2 run <code>adb connect &lt;IP>:5555</code> where <code>&lt;IP></code> is the local network IP address of your Android device</p></li><li><p>The output might contain something like &ldquo;failed to authenticate to :5555&rdquo; but there may have another prompt to
accept on the Android device. Run the <code>adb connect</code> command again and it should output something like &ldquo;already
connected to :5555&rdquo;</p></li><li><p>In WSL2 confirm that <code>adb devices</code> now lists the Android device.</p><pre tabindex=0><code>❯ adb devices
List of devices attached
&lt;IP&gt;:5555      device
</code></pre></li></ol><h2 id=transfer-the-app-files>Transfer the App files<a hidden class=anchor aria-hidden=true href=#transfer-the-app-files>#</a></h2><p>First, we need to know the app identifier for the target app. In my case, the target app is Marvel Snap. We use <code>adb shell pm list packages</code> to list the app identifiers of all installed apps on the device. Hopefully, your target app has
an identifier you can recognize. The output of the command will look like this:</p><pre tabindex=0><code>❯ adb shell pm list packages
package:com.google.audio.hearing.visualization.accessibility.scribe
package:com.android.systemui.auto_generated_rro_vendor__
package:com.google.android.providers.media.module
package:com.google.android.overlay.permissioncontroller
package:com.google.android.overlay.googlewebview
package:com.android.calllogbackup
&lt;Truncated...&gt;
</code></pre><p>Marvel Snap will appear in the list as <code>package:com.nvsgames.snap</code>. Next, we need to discover the path on the device to
the installed app. The path is lightly obfuscated and will change each time you install the app. Now we use <code>adb shell pm path com.nvsgames.snap</code> to discover the path we need.</p><pre tabindex=0><code>❯ adb shell pm path com.nvsgames.snap
package:/data/app/~~3ptHVzClzNmwSowM3hAu0A==/com.nvsgames.snap-kVFALO2K7yXXBtqhMI35dw==/base.apk
package:/data/app/~~3ptHVzClzNmwSowM3hAu0A==/com.nvsgames.snap-kVFALO2K7yXXBtqhMI35dw==/split_config.arm64_v8a.apk
</code></pre><p>We can see above that the path we need for the next step is
<code>/data/app/~~3ptHVzClzNmwSowM3hAu0A==/com.nvsgames.snap-kVFALO2K7yXXBtqhMI35dw==/</code>. Finally, we can copy the files to
the computer where the device is connected. Change to the directory where we want to copy files to and run <code>adb pull &lt;path></code> where <code>&lt;path></code> is the app path we found above. The command output will update as it copies files but after it
has completed it will look similar to below:</p><pre tabindex=0><code>❯ adb pull /data/app/~~3ptHVzClzNmwSowM3hAu0A==/com.nvsgames.snap-kVFALO2K7yXXBtqhMI35dw==/
adb: warning: skipping special file &#39;/data/app/~~3ptHVzClzNmwSowM3hAu0A==/com.nvsgames.snap-kVFALO2K7yXXBtqhMI35dw==/oat&#39; (mode = 0o0)
/data/app/~~3ptHVzClzNmwSowM3hAu0A==/com.nvsgames.snap-kVFALO2K7yXXBtqhMI35dw==/: 35 files pulled, 1 skipped. 18.8 MB/s (256557359 bytes in 13.032s)
</code></pre><h2 id=analyzing-the-app-files>Analyzing the App files<a hidden class=anchor aria-hidden=true href=#analyzing-the-app-files>#</a></h2><p>Great! The files are on our computer and ready for further analysis. This post is by no means an extensive analysis
guide but next, I&rsquo;ll point out a few things related to the sizes of different sections of the app. We will also take a
look at deconstructing parts of the Unity app to see its contents.</p><p>Before we get too far, let&rsquo;s take a quick look at the contents of the files we transferred. For Snap, it should look
like the following:</p><pre tabindex=0><code>❯ tree
.
├── base.apk
├── base.dm
├── lib
│   └── arm64
│       ├── libalog.so
│       ├── libbacktrace-native.so
│       ├── libbreakpad_client.so
│       ├── lib_burst_generated.so
│       ├── libbytehook.so
│       ├── libcpuinfo.so
│       ├── libcrashpad_handler.so
│       ├── libc++_shared.so
│       ├── libEncryptor.so
│       ├── libgp_base.so
│       ├── libgpm.so
│       ├── libgp.so
│       ├── libgsdk_base.so
│       ├── libil2cpp.so
│       ├── libkeva.so
│       ├── libmain.so
│       ├── libmonitorcollector-lib.so
│       ├── libnative-lib.so
│       ├── libnpth_dl.so
│       ├── libnpth_dumper.so
│       ├── libnpth_heap_tracker.so
│       ├── libnpth_logcat.so
│       ├── libnpth.so
│       ├── libnpth_tools.so
│       ├── libnpth_wrapper.so
│       ├── libnpth_xasan.so
│       ├── libping.so
│       ├── libsscronet.so
│       ├── libttboringssl.so
│       ├── libttcrypto.so
│       ├── libttgame_tps_client.so
│       └── libunity.so
└── split_config.arm64_v8a.apk
</code></pre><p>Snap is a relatively simple package. Everything fits in the base APK and no Android Asset Packs are used to provide
additional data. There is a limit to how large the base APK can be before asset packs must be introduced. Asset packs
themselves have size and quantity limits. To learn more about asset packs, check out the <a href=https://developer.android.com/guide/playcore/asset-delivery>Play Asset Delivery
documentation</a>. An additional point of interest is that if
an App Store download is under 150mb, it can be downloaded on a mobile data plan without prompting the user. It&rsquo;s
assumed that more users will download your app if they are not concerned about it using a significant portion of a
user&rsquo;s monthly data cap.</p><p>When an app is submitted to the Play Store, it will be processed by Google. The base APK will have binaries split into
additional APKs for each supported target architecture. We can see in the output above that the binary APK is called
<code>split_config.arm64_v8a.apk</code>.</p><p>Additionally, the binary APK contains compressed binaries that need to be extracted before the app can run. During app
installation, the binaries are extracted to the <code>lib/</code> directory as seen in the output above.</p><p>Analyzing the binaries may give insight into how the app is structured or what third-party libraries the app is using.
Snap is a Unity app so it&rsquo;s no surprise that we see <code>libunity.so</code> and <code>libil2cpp.so</code>. As an arbitrary example, we can
see that Snap is using <a href=https://backtrace.io/>Backtrace</a> for crash and error reporting based on the presence of
<code>libbacktrace-native.so</code> and <code>libcrashpad_handler.so</code>.</p><h3 id=analyzing-binary-sizes>Analyzing Binary Sizes<a hidden class=anchor aria-hidden=true href=#analyzing-binary-sizes>#</a></h3><p>We can easily look at the binaries in <code>lib/</code> to understand the extracted size of the files; however, I am more
interested in the compressed size of binaries as it relates to App Store size limits and the 150mb threshold. We need to
have a look inside the binary APK and to do this we will use the <code>zipinfo</code> command. If you don&rsquo;t have <code>zipinfo</code>
installed, you can install it on WSL2 with <code>sudo adb install zip unzip</code>. We could simply look at the size of the binary
APK to understand the size of all binaries but I&rsquo;m interested in looking at the size of individual binaries.</p><p>Let&rsquo;s take a look by running <code>zipinfo -lt split_config.arm64_v8a.apk</code></p><pre tabindex=0><code>❯ zipinfo -lt split_config.arm64_v8a.apk
Archive:  split_config.arm64_v8a.apk
Zip file size: 40147658 bytes, number of entries: 37
-rw-r--r--  0.0 unx      952 b-      419 defN 81-Jan-01 01:01 AndroidManifest.xml
-rw-r--r--  0.0 unx    75744 b-    25809 defN 81-Jan-01 01:01 lib/arm64-v8a/libEncryptor.so
-rw-r--r--  0.0 unx   361000 b-   158184 defN 81-Jan-01 01:01 lib/arm64-v8a/lib_burst_generated.so
-rw-r--r--  0.0 unx   121208 b-    66067 defN 81-Jan-01 01:01 lib/arm64-v8a/libalog.so
-rw-r--r--  0.0 unx  1485240 b-   464514 defN 81-Jan-01 01:01 lib/arm64-v8a/libbacktrace-native.so
-rw-r--r--  0.0 unx   182328 b-    69734 defN 81-Jan-01 01:01 lib/arm64-v8a/libbreakpad_client.so
-rw-r--r--  0.0 unx    43536 b-    20925 defN 81-Jan-01 01:01 lib/arm64-v8a/libbytehook.so
-rw-r--r--  0.0 unx   911696 b-   272821 defN 81-Jan-01 01:01 lib/arm64-v8a/libc++_shared.so
-rw-r--r--  0.0 unx    27456 b-    10914 defN 81-Jan-01 01:01 lib/arm64-v8a/libcpuinfo.so
-rw-r--r--  0.0 unx  2917440 b-  1344878 defN 81-Jan-01 01:01 lib/arm64-v8a/libcrashpad_handler.so
-rw-r--r--  0.0 unx  3395632 b-  1241680 defN 81-Jan-01 01:01 lib/arm64-v8a/libgp.so
-rw-r--r--  0.0 unx   519264 b-   207392 defN 81-Jan-01 01:01 lib/arm64-v8a/libgp_base.so
-rw-r--r--  0.0 unx   977104 b-   310883 defN 81-Jan-01 01:01 lib/arm64-v8a/libgpm.so
-rw-r--r--  0.0 unx    10312 b-     3595 defN 81-Jan-01 01:01 lib/arm64-v8a/libgsdk_base.so
-rw-r--r--  0.0 unx 85567976 b- 24113775 defN 81-Jan-01 01:01 lib/arm64-v8a/libil2cpp.so
-rw-r--r--  0.0 unx   203368 b-    67908 defN 81-Jan-01 01:01 lib/arm64-v8a/libkeva.so
-rw-r--r--  0.0 unx    10416 b-     2629 defN 81-Jan-01 01:01 lib/arm64-v8a/libmain.so
-rw-r--r--  0.0 unx   243992 b-    87711 defN 81-Jan-01 01:01 lib/arm64-v8a/libmonitorcollector-lib.so
-rw-r--r--  0.0 unx   223288 b-    76642 defN 81-Jan-01 01:01 lib/arm64-v8a/libnative-lib.so
-rw-r--r--  0.0 unx    76616 b-    37492 defN 81-Jan-01 01:01 lib/arm64-v8a/libnpth.so
-rw-r--r--  0.0 unx    26560 b-    11422 defN 81-Jan-01 01:01 lib/arm64-v8a/libnpth_dl.so
-rw-r--r--  0.0 unx   121704 b-    63883 defN 81-Jan-01 01:01 lib/arm64-v8a/libnpth_dumper.so
-rw-r--r--  0.0 unx    59344 b-    27079 defN 81-Jan-01 01:01 lib/arm64-v8a/libnpth_heap_tracker.so
-rw-r--r--  0.0 unx    27000 b-    11889 defN 81-Jan-01 01:01 lib/arm64-v8a/libnpth_logcat.so
-rw-r--r--  0.0 unx    83896 b-    35318 defN 81-Jan-01 01:01 lib/arm64-v8a/libnpth_tools.so
-rw-r--r--  0.0 unx     6048 b-     1425 defN 81-Jan-01 01:01 lib/arm64-v8a/libnpth_wrapper.so
-rw-r--r--  0.0 unx    42920 b-    17910 defN 81-Jan-01 01:01 lib/arm64-v8a/libnpth_xasan.so
-rw-r--r--  0.0 unx    14144 b-     4765 defN 81-Jan-01 01:01 lib/arm64-v8a/libping.so
-rw-r--r--  0.0 unx  4428584 b-  2029259 defN 81-Jan-01 01:01 lib/arm64-v8a/libsscronet.so
-rw-r--r--  0.0 unx   341976 b-   142671 defN 81-Jan-01 01:01 lib/arm64-v8a/libttboringssl.so
-rw-r--r--  0.0 unx  1170688 b-   466898 defN 81-Jan-01 01:01 lib/arm64-v8a/libttcrypto.so
-rw-r--r--  0.0 unx   530640 b-   248325 defN 81-Jan-01 01:01 lib/arm64-v8a/libttgame_tps_client.so
-rw-r--r--  0.0 unx 20348216 b-  8486117 defN 81-Jan-01 01:01 lib/arm64-v8a/libunity.so
-rw----     2.0 fat       32 b-       35 defN 81-Jan-01 01:01 stamp-cert-sha256
-rw----     2.0 fat     2912 b-     1200 defN 81-Jan-01 01:01 META-INF/BNDLTOOL.SF
-rw----     2.0 fat     1405 b-     1067 defN 81-Jan-01 01:01 META-INF/BNDLTOOL.RSA
-rw----     2.0 fat     2804 b-     1125 defN 81-Jan-01 01:01 META-INF/MANIFEST.MF
37 files, 124563441 bytes uncompressed, 40134360 bytes compressed:  67.8%
</code></pre><p>We can see in the last line the total uncompressed and compressed size of all the files. We also see a compression
ratio of 67.8%. For each file, we can see the compressed and uncompressed size in bytes of each file. If you would
rather see the compression ratio as a percent instead of size in bytes, you can change the arguments we used and run
<code>zipinfo -mt split_config.arm64_v8a.apk</code></p><pre tabindex=0><code>❯ zipinfo -mt split_config.arm64_v8a.apk
Archive:  split_config.arm64_v8a.apk
Zip file size: 40147658 bytes, number of entries: 37
-rw-r--r--  0.0 unx      952 b- 56% defN 81-Jan-01 01:01 AndroidManifest.xml
-rw-r--r--  0.0 unx    75744 b- 66% defN 81-Jan-01 01:01 lib/arm64-v8a/libEncryptor.so
-rw-r--r--  0.0 unx   361000 b- 56% defN 81-Jan-01 01:01 lib/arm64-v8a/lib_burst_generated.so
-rw-r--r--  0.0 unx   121208 b- 46% defN 81-Jan-01 01:01 lib/arm64-v8a/libalog.so
-rw-r--r--  0.0 unx  1485240 b- 69% defN 81-Jan-01 01:01 lib/arm64-v8a/libbacktrace-native.so
-rw-r--r--  0.0 unx   182328 b- 62% defN 81-Jan-01 01:01 lib/arm64-v8a/libbreakpad_client.so
-rw-r--r--  0.0 unx    43536 b- 52% defN 81-Jan-01 01:01 lib/arm64-v8a/libbytehook.so
-rw-r--r--  0.0 unx   911696 b- 70% defN 81-Jan-01 01:01 lib/arm64-v8a/libc++_shared.so
-rw-r--r--  0.0 unx    27456 b- 60% defN 81-Jan-01 01:01 lib/arm64-v8a/libcpuinfo.so
-rw-r--r--  0.0 unx  2917440 b- 54% defN 81-Jan-01 01:01 lib/arm64-v8a/libcrashpad_handler.so
-rw-r--r--  0.0 unx  3395632 b- 63% defN 81-Jan-01 01:01 lib/arm64-v8a/libgp.so
-rw-r--r--  0.0 unx   519264 b- 60% defN 81-Jan-01 01:01 lib/arm64-v8a/libgp_base.so
-rw-r--r--  0.0 unx   977104 b- 68% defN 81-Jan-01 01:01 lib/arm64-v8a/libgpm.so
-rw-r--r--  0.0 unx    10312 b- 65% defN 81-Jan-01 01:01 lib/arm64-v8a/libgsdk_base.so
-rw-r--r--  0.0 unx 85567976 b- 72% defN 81-Jan-01 01:01 lib/arm64-v8a/libil2cpp.so
-rw-r--r--  0.0 unx   203368 b- 67% defN 81-Jan-01 01:01 lib/arm64-v8a/libkeva.so
-rw-r--r--  0.0 unx    10416 b- 75% defN 81-Jan-01 01:01 lib/arm64-v8a/libmain.so
-rw-r--r--  0.0 unx   243992 b- 64% defN 81-Jan-01 01:01 lib/arm64-v8a/libmonitorcollector-lib.so
-rw-r--r--  0.0 unx   223288 b- 66% defN 81-Jan-01 01:01 lib/arm64-v8a/libnative-lib.so
-rw-r--r--  0.0 unx    76616 b- 51% defN 81-Jan-01 01:01 lib/arm64-v8a/libnpth.so
-rw-r--r--  0.0 unx    26560 b- 57% defN 81-Jan-01 01:01 lib/arm64-v8a/libnpth_dl.so
-rw-r--r--  0.0 unx   121704 b- 48% defN 81-Jan-01 01:01 lib/arm64-v8a/libnpth_dumper.so
-rw-r--r--  0.0 unx    59344 b- 54% defN 81-Jan-01 01:01 lib/arm64-v8a/libnpth_heap_tracker.so
-rw-r--r--  0.0 unx    27000 b- 56% defN 81-Jan-01 01:01 lib/arm64-v8a/libnpth_logcat.so
-rw-r--r--  0.0 unx    83896 b- 58% defN 81-Jan-01 01:01 lib/arm64-v8a/libnpth_tools.so
-rw-r--r--  0.0 unx     6048 b- 76% defN 81-Jan-01 01:01 lib/arm64-v8a/libnpth_wrapper.so
-rw-r--r--  0.0 unx    42920 b- 58% defN 81-Jan-01 01:01 lib/arm64-v8a/libnpth_xasan.so
-rw-r--r--  0.0 unx    14144 b- 66% defN 81-Jan-01 01:01 lib/arm64-v8a/libping.so
-rw-r--r--  0.0 unx  4428584 b- 54% defN 81-Jan-01 01:01 lib/arm64-v8a/libsscronet.so
-rw-r--r--  0.0 unx   341976 b- 58% defN 81-Jan-01 01:01 lib/arm64-v8a/libttboringssl.so
-rw-r--r--  0.0 unx  1170688 b- 60% defN 81-Jan-01 01:01 lib/arm64-v8a/libttcrypto.so
-rw-r--r--  0.0 unx   530640 b- 53% defN 81-Jan-01 01:01 lib/arm64-v8a/libttgame_tps_client.so
-rw-r--r--  0.0 unx 20348216 b- 58% defN 81-Jan-01 01:01 lib/arm64-v8a/libunity.so
-rw----     2.0 fat       32 b- -8% defN 81-Jan-01 01:01 stamp-cert-sha256
-rw----     2.0 fat     2912 b- 59% defN 81-Jan-01 01:01 META-INF/BNDLTOOL.SF
-rw----     2.0 fat     1405 b- 24% defN 81-Jan-01 01:01 META-INF/BNDLTOOL.RSA
-rw----     2.0 fat     2804 b- 60% defN 81-Jan-01 01:01 META-INF/MANIFEST.MF
37 files, 124563441 bytes uncompressed, 40134360 bytes compressed:  67.8%
</code></pre><p>A quick observation is that the Unity app binaries are large. I also checked apps like Clash Royale and
Brawl Stars. Their binary sizes were significantly smaller. The Unity engine alone can be as large as the code base for
entire games.</p><h3 id=analyzing-embedded-asset-bundles>Analyzing Embedded Asset Bundles<a hidden class=anchor aria-hidden=true href=#analyzing-embedded-asset-bundles>#</a></h3><p>Using <a href=https://ibotpeaches.github.io/Apktool/>apktool</a> we can unpack <code>base.apk</code>. <code>apktool</code> can be installed with <code>sudo apt install apktool</code>. It&rsquo;s worth noting that an APK is essentially a zip archive. You can extract it like a regular zip
archive. Hopefully, this was apparent when we used <code>zipinfo</code> to look inside the binary APK. However, simply unzipping
the APK will leave parts like the <code>AndroidManifest.xml</code> unreadable.</p><p>Unpack the base APK with <code>apktool d base.apk</code>.</p><pre tabindex=0><code>❯ apktool d base.apk
I: Using Apktool 2.5.0-dirty on base.apk
I: Loading resource table...
I: Decoding AndroidManifest.xml with resources...
I: Loading resource table from file: /home/hfarrow/.local/share/apktool/framework/1.apk
I: Regular manifest package...
I: Decoding file-resources...
I: Decoding values */* XMLs...
I: Baksmaling classes.dex...
I: Baksmaling classes2.dex...
I: Baksmaling classes3.dex...
I: Baksmaling classes4.dex...
I: Baksmaling classes5.dex...
I: Baksmaling classes6.dex...
I: Copying assets and libs...
I: Copying unknown files...
I: Copying original files...
I: Copying META-INF/services directory
</code></pre><p>We should now see a directory named <code>base</code>. Here is a look at the top-level directory listing:</p><pre tabindex=0><code>❯ tree -L 1
.
├── AndroidManifest.xml
├── apktool.yml
├── assets
├── kotlin
├── META-INF
├── original
├── res
├── smali
├── smali_classes2
├── smali_classes3
├── smali_classes4
├── smali_classes5
├── smali_classes6
└── unknown
</code></pre><p>Notice that if you open <code>AndroidManifest.xml</code> it will be readable. We aren&rsquo;t interested in the manifest for the purpose
of this post but it&rsquo;s useful to know about. Even when troubleshooting your own Unity app, it can be useful to view the
manifest in your built APK to verify the final manifest is what you expected.</p><p>We are interested in app size so let&rsquo;s take a high-level look at the distribution of large files in the APK. Another
handy tool I used in my terminal is <a href=https://github.com/Canop/broot>broot</a>. It has &ldquo;whale&rdquo; mode that will sort and
display files by size. Install <code>broot</code> with <code>sudo apt install broot</code> and then run <code>broot -m</code> in the unpacked APK
directory.</p><p><img loading=lazy src=broot-base-whale.png alt></p><p>For our purposes, we are interested in the <code>assets</code> directory where we will find the contents of the Unity project&rsquo;s
<code>Assets/StreamingAssets/</code>, and all the assets that were embedded as part of scenes and <code>Resources/</code> directories. Let&rsquo;s
move <code>broot</code> into the <code>assets</code> directory and take another look.</p><p><img loading=lazy src=broot-assets-whale.png alt></p><p>From inspecting the contents of <code>aa</code> we can determine that Snap uses the Addressable system and that the Android
directory contains asset bundles embedded into the app.</p><p><img loading=lazy src=broot-bundles-whale.png alt></p><p>When you embed asset bundles into a Unity APK, you have the decision to make. Do you compress the asset bundle in the
APK archive or do you leave them uncompressed? Compressing the bundles is in addition to the compression setting used to
build the individual bundles. That is to say, you can double-compress asset bundles. The contents of a bundle itself can
be compressed and the section of the APK archive containing the bundle can also be compressed.</p><p>Compressing bundles in the APK will help reduce the size of your APK but it comes with a significant trade-off. At
runtime, loading an asset bundle out of the APK will be significantly slower because Unity will have to extract the file
out of the APK to read it into memory. As an example, in a game I worked on where we pre-loaded many bundles,
compressing the bundles increased app startup time by at least a multiple of 4 on decent hardware. You can improve this
experience by extracting the asset bundles and caching them outside of the APK. Unity has a built-in asset bundle cache
and if you load bundles through a
<a href=https://docs.unity3d.com/ScriptReference/Networking.UnityWebRequest.html>UnityWebRequest</a>, I believe it will
automatically perform this step for you. There is still a trade-off that the first time you load a bundle, you need to
extract it. The app should be tested to determine how this affects the user experience and if the trade-off is
acceptable. Having longer load times on a player&rsquo;s first session might impact their impression negatively. No one likes
long loading phases.</p><p>So, are Snap bundles compressed in the APK or not? We can go back to <code>zipinfo</code> to analyze the <code>base.apk</code>. <code>zipinfo</code> can
take a trailing argument that is a file filter for the output. Try running <code>zipinfo -m base.apk assets/aa/Android/\*</code> to
only output info about the asset bundles. Below we can see the first few lines of output but all the bundles are using
the same compression strategy.</p><pre tabindex=0><code>❯ zipinfo -m base.apk assets/aa/Android/\*
-rw-r--r--  0.0 unx     3566 b- 19% defN 81-Jan-01 01:01 assets/aa/Android/0ea51b79af36d03ba15ac4b5ea3be170.bundle
-rw-r--r--  0.0 unx     3547 b- 19% defN 81-Jan-01 01:01 assets/aa/Android/4ed2cdfb0e9393601d4ffe68e478f867.bundle
-rw-r--r--  0.0 unx     4850 b- 23% defN 81-Jan-01 01:01 assets/aa/Android/515070c0151e19d075d62b181d0d1c29.bundle
-rw-r--r--  0.0 unx     9698 b- 20% defN 81-Jan-01 01:01 assets/aa/Android/5e4bad4874a8ef52921df1b8d1188b7c.bundle
-rw-r--r--  0.0 unx    20358 b- 18% defN 81-Jan-01 01:01 assets/aa/Android/6c14c35b58746c8605fc410e435b38b5.bundle
-rw-r--r--  0.0 unx    70554 b- 40% defN 81-Jan-01 01:01 assets/aa/Android/6e507c8d892466c20bdc6e65eeff6f19.bundle
-rw-r--r--  0.0 unx     4716 b- 20% defN 81-Jan-01 01:01 assets/aa/Android/87b3b19c363616f26590d1191c153135.bundle
-rw-r--r--  0.0 unx     8920 b- 18% defN 81-Jan-01 01:01 assets/aa/Android/8965793a594f49ff7b8283b12bdab12b.bundle
-rw-r--r--  0.0 unx    14902 b- 18% defN 81-Jan-01 01:01 assets/aa/Android/93d9c5e9586500293f5fe79095052b54.bundle
-rw-r--r--  0.0 unx   110994 b- 17% defN 81-Jan-01 01:01 assets/aa/Android/b0d5d1c80db4e7ada5b102f136b05c06.bundle
-rw-r--r--  0.0 unx  1844795 b-  0% defN 81-Jan-01 01:01 assets/aa/Android/baked-smalllogos_assets_all_a01de1e78f3277d29d3895934ef45348.bundle
-rw-r--r--  0.0 unx  2239676 b- 15% defN 81-Jan-01 01:01 assets/aa/Android/bundledinapp-card_assets_all_72d770ac4c8ab54515d4be59bf32c3eb.bundle
-rw-r--r--  0.0 unx     8582 b- 22% defN 81-Jan-01 01:01 assets/aa/Android/bundledinapp-font_assets_applesdf_3f50ebe88e074a9767830cc1fb5c5f24.bundle
-rw-r--r--  0.0 unx     8103 b- 21% defN 81-Jan-01 01:01 assets/aa/Android/bundledinapp-font_assets_contentsdf_0e9b61d8eb8d950cf81900554acab2a1.bundle
-rw-r--r--  0.0 unx     8596 b- 22% defN 81-Jan-01 01:01 assets/aa/Android/bundledinapp-font_assets_googlesdf_2263bf4501d15f601a859e5d86fafa67.bundle
-rw-r--r--  0.0 unx    22919 b- 21% defN 81-Jan-01 01:01 assets/aa/Android/bundledinapp-font_assets_header_891ee8005509ee8884e463deb3b810f2.bundle
-rw-r--r--  0.0 unx     8158 b- 21% defN 81-Jan-01 01:01 assets/aa/Android/bundledinapp-font_assets_headersdf_cc807b1a807e72e2f7bb8d9ef97eb82a.bundle
-rw-r--r--  0.0 unx   353188 b- 11% defN 81-Jan-01 01:01 assets/aa/Android/bundledinapp-font_assets_helveticaneueltstd-mdcnsdf_a49787f3b1b5550c636345c5aaa010e9.bundle
-rw-r--r--  0.0 unx    29498 b- 29% defN 81-Jan-01 01:01 assets/aa/Android/bundledinapp-font_assets_tmp_sdf-mobile_590e52215c1985ca7d514bcd1eee9c5b.bundle
-rw-r--r--  0.0 unx    31015 b- 29% defN 81-Jan-01 01:01 assets/aa/Android/bundledinapp-font_assets_tmp_sdf-mobilemasking_f14fca07d81ca13d20379d31d61ecd97.bundle
&lt;Truncated...&gt;
</code></pre><p>At a glance, we can confirm the asset bundles are compressed. The <code>defN</code> value in the 7th column confirms this but so
does the fact that we see compression ratios in the 6th column. Interestingly and assuming this was a deliberate choice,
this may have helped the developers keep their APK under the Play Store 150mb limit I mentioned previously. I won&rsquo;t go
so far for this post but one could play the app and inspect the app data to see if the embedded bundles are being cached
outside of the APK.</p><p>The compression ratio varies widely among the bundles. We can see values ranging from single digits up to
59%. If you run <code>zipinfo</code> again with the <code>-t</code> flag added, the final line of output will include the total compression
ratio of all files. We see that the overall compression ratio is 10.5%.</p><pre tabindex=0><code>❯ zipinfo -mt base.apk assets/aa/Android/\*
&lt;Truncated...&gt;
235 files, 65842186 bytes uncompressed, 58926405 bytes compressed:  10.5%
</code></pre><h3 id=analyzing-asset-bundles-contents>Analyzing Asset Bundles Contents<a hidden class=anchor aria-hidden=true href=#analyzing-asset-bundles-contents>#</a></h3><p>In the previous steps, we already extracted all asset bundles when we unpacked the <code>base.apk</code> and they can be found in
<code>./base/assets/aa/Android/</code>. We can create an empty Unity project and install the <a href=https://docs.unity3d.com/Manual/AssetBundles-Browser.html>Asset Bundle
Browser</a> tool package. The link contains installation
instructions and a link to the tool&rsquo;s documentation. With this tool, we can add the <code>assets/aa/Android/</code> directory and
inspect all the bundles together. We can collect a lot of information about the bundles doing this but I&rsquo;ve chosen to
skip doing so for this post.</p><p><img loading=lazy src=asset-bundle-browser.png alt></p><h3 id=analyzing-embedded-scenes-and-resources>Analyzing Embedded Scenes and Resources<a hidden class=anchor aria-hidden=true href=#analyzing-embedded-scenes-and-resources>#</a></h3><p>We already looked at asset bundles but what about all the assets referenced by embedded scenes and assets found inside
<code>Resources/</code> directories in the project&rsquo;s <code>Assets/</code> directory? All of that data can be found in
<code>base/assets/bin/Data/data.unity3d</code>.</p><p>I may come back in the future and expand this section further but for now, I&rsquo;ll just point out that a tool called <a href=https://assetripper.github.io/AssetRipper/>Asset
Ripper</a> that can both inspect the contents of this file and export a Unity
project containing much of the contents. For a Standalone player using the mono backend you can decompile scripts but
for an Android or iOS game using the IL2CPP backend that will not be possible. Asset Ripper is an insightful tool for
looking at the contents and structure of the project. For my purposes, I was interested in looking at how much font
data was embedded in the APK and I accomplished that goal with this tool.</p><p>Asset Ripper can also be used to inspect and unpack individual assets bundles; although, I didn&rsquo;t go that far for my
purposes as the Asset Bundle Browser was sufficient and more convenient to use.</p><p>There is a lot more to be said about deconstructing, reverse engineering, and analyzing an Android app but I think this
serves as a good introduction to the topic.</p></div><footer class=post-footer><ul class=post-tags></ul><nav class=paginav><a class=next href=https://heathfarrow.dev/posts/development-with-neovim/><span class=title>Next »</span><br><span>Development with Neovim</span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share Deconstructing Unity Android Apps on twitter" href="https://twitter.com/intent/tweet/?text=Deconstructing%20Unity%20Android%20Apps&url=https%3a%2f%2fheathfarrow.dev%2fposts%2fdeconstructing-unity-android-apps%2f&hashtags="><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Deconstructing Unity Android Apps on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fheathfarrow.dev%2fposts%2fdeconstructing-unity-android-apps%2f&title=Deconstructing%20Unity%20Android%20Apps&summary=Deconstructing%20Unity%20Android%20Apps&source=https%3a%2f%2fheathfarrow.dev%2fposts%2fdeconstructing-unity-android-apps%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Deconstructing Unity Android Apps on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fheathfarrow.dev%2fposts%2fdeconstructing-unity-android-apps%2f&title=Deconstructing%20Unity%20Android%20Apps"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Deconstructing Unity Android Apps on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fheathfarrow.dev%2fposts%2fdeconstructing-unity-android-apps%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Deconstructing Unity Android Apps on whatsapp" href="https://api.whatsapp.com/send?text=Deconstructing%20Unity%20Android%20Apps%20-%20https%3a%2f%2fheathfarrow.dev%2fposts%2fdeconstructing-unity-android-apps%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Deconstructing Unity Android Apps on telegram" href="https://telegram.me/share/url?text=Deconstructing%20Unity%20Android%20Apps&url=https%3a%2f%2fheathfarrow.dev%2fposts%2fdeconstructing-unity-android-apps%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></main><footer class=footer><span>&copy; 2023 <a href=https://heathfarrow.dev>Heath Farrow .dev</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script src=https://cdnjs.cloudflare.com/ajax/libs/medium-zoom/1.0.6/medium-zoom.min.js integrity="sha512-N9IJRoc3LaP3NDoiGkcPa4gG94kapGpaA5Zq9/Dr04uf5TbLFU5q0o8AbRhLKUUlp8QFS2u7S+Yti0U7QtuZvQ==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script>const images=Array.from(document.querySelectorAll(".post-content img"));images.forEach(e=>{mediumZoom(e,{margin:0,scrollOffset:40,container:null,template:null})})</script><script type=module src=https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.esm.js></script>
<script nomodule src=https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.js></script>
<script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>